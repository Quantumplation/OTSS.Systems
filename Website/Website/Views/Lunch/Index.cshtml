@model System.Collections.Generic.ICollection<Website.ViewModels.API.LunchPollViewModel>
@{
    ViewBag.Title = "Lunch Management System";

    var current = Model.FirstOrDefault(m => m.Info.Voters.Contains(User.Identity.Name));
    var currentId = current != null ? current.Id : default(int?); @*mvc5 razor can't into c#6 :(*@
}

<h1>@ViewBag.Title</h1>
<hr />
@Html.React("Page", new
{
    username = User.Identity.Name,
    initialPolls = Model.ToDictionary(p => p.Id),
    initialSelected = currentId
})

@section Scripts {
    <script src="~/Scripts/jquery.signalR-2.0.3.min.js"></script>
    <script src="~/signalr/hubs"></script>
    <script src="~/Scripts/typeahead.jquery.js"></script>
    <script src="~/Scripts/bloodhound.js"></script>
    <script src="~/Scripts/lunch.js"></script>
    <script src="~/Scripts/react/react-0.13.1.js"></script>
    <script src="~/Scripts/lms.jsx"></script>
    @Html.ReactInitJavaScript()

    <script>
    $(function() {
        $('#current-poll .has-tooltip').tooltip();
        lunchAutocomplete("#option-box");
    });
    </script>
}